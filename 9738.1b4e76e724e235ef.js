"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5704,5864,9738],{3923:(L,y,r)=>{r.d(y,{$o:()=>h,_G:()=>v,Vq:()=>F,SQ:()=>s});var h=function(n){return n.Loaded="applePayLoaded",n.FailedToLoad="applePayFailedToLoad",n.Completed="applePayCompleted",n.Canceled="applePayCanceled",n.Failed="applePayFailed",n.DidSelectShippingContact="applePayDidSelectShippingContact",n.DidCreatePaymentMethod="applePayDidCreatePaymentMethod",n}(h||{}),v=function(n){return n.Loaded="googlePayLoaded",n.FailedToLoad="googlePayFailedToLoad",n.Completed="googlePayCompleted",n.Canceled="googlePayCanceled",n.Failed="googlePayFailed",n}(v||{}),F=function(n){return n.Loaded="paymentFlowLoaded",n.FailedToLoad="paymentFlowFailedToLoad",n.Opened="paymentFlowOpened",n.Created="paymentFlowCreated",n.Completed="paymentFlowCompleted",n.Canceled="paymentFlowCanceled",n.Failed="paymentFlowFailed",n}(F||{}),s=function(n){return n.Loaded="paymentSheetLoaded",n.FailedToLoad="paymentSheetFailedToLoad",n.Completed="paymentSheetCompleted",n.Canceled="paymentSheetCanceled",n.Failed="paymentSheetFailed",n}(s||{})},9738:(L,y,r)=>{r.r(y),r.d(y,{CheckoutPage:()=>z});var h=r(467),v=r(177),F=r(4341),s=r(4742),n=r(3804),M=r(7564),D=r(5704),T=r(5864),t=r(4438),G=r(2068),o=r(9568);const S=()=>[0,1];function $(a,d){if(1&a&&(t.j41(0,"ion-title"),t.EFF(1),t.k0s()),2&a){const e=t.XpG();t.R7$(),t.JRh(e.text.checkout_title)}}function p(a,d){1&a&&t.nrm(0,"ion-skeleton-text",11),2&a&&t.Y8G("animated",!0)}function b(a,d){if(1&a&&(t.j41(0,"div"),t.DNE(1,p,1,1,"ion-skeleton-text",10),t.k0s()),2&a){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.fakeData)}}function m(a,d){1&a&&(t.j41(0,"ion-col",26),t.nrm(1,"img",27),t.k0s())}function x(a,d){if(1&a&&(t.j41(0,"small",28),t.EFF(1),t.k0s()),2&a){const e=t.XpG(3);t.R7$(),t.JRh(e.address.address)}}function k(a,d){if(1&a&&(t.j41(0,"ion-select-option",29),t.EFF(1),t.k0s()),2&a){const e=d.$implicit;t.Y8G("value",e.id),t.R7$(),t.JRh(e.title)}}function j(a,d){if(1&a&&(t.j41(0,"ion-select-option",29),t.EFF(1),t.k0s()),2&a){const e=d.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function X(a,d){if(1&a&&(t.j41(0,"ion-row")(1,"ion-col",33),t.EFF(2),t.k0s(),t.j41(3,"ion-col",34),t.EFF(4),t.k0s(),t.j41(5,"ion-col",35),t.EFF(6),t.k0s(),t.j41(7,"ion-col",35),t.EFF(8),t.k0s()()),2&a){const e=d.$implicit,i=t.XpG(4);t.R7$(2),t.Lme("",e.item," - ",e.type,""),t.R7$(2),t.LHq("",i.text.start," : ",e.start," | ",i.text.valid," : ",e.end,""),t.R7$(2),t.Lme("",i.text.total_day_count," : ",e.dayCount,""),t.R7$(2),t.ZXR("",i.text.amount," : ",e.currency,"",e.price," x ",e.dayCount," = ",e.currency,"",e.total_price,"")}}function B(a,d){if(1&a&&(t.j41(0,"h3"),t.EFF(1),t.k0s()),2&a){const e=t.XpG(4);t.R7$(),t.E5c("",e.text.payable_amount," : ",e.cal.currency,"",e.cal.total,"")}}function u(a,d){if(1&a&&(t.j41(0,"h3",36),t.EFF(1),t.j41(2,"s"),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()),2&a){const e=t.XpG(4);t.R7$(),t.SpI("",e.text.payable_amount," : "),t.R7$(2),t.Lme("",e.cal.currency,"",e.cal.total,""),t.R7$(),t.Lme(" ",e.cal.currency,"",e.total,"")}}function C(a,d){if(1&a&&(t.j41(0,"div",30),t.DNE(1,X,9,14,"ion-row",31)(2,B,2,3,"h3",2)(3,u,5,5,"h3",32),t.k0s()),2&a){const e=t.XpG(3);t.R7$(),t.Y8G("ngForOf",e.cal.summery),t.R7$(),t.Y8G("ngIf",!e.save),t.R7$(),t.Y8G("ngIf",e.save)}}function g(a,d){if(1&a&&(t.j41(0,"small",39),t.EFF(1),t.k0s()),2&a){const e=t.XpG(4);t.R7$(),t.E5c("",e.text.you_save," ",e.cal.currency,"",e.save,"")}}function l(a,d){if(1&a){const e=t.RV6();t.j41(0,"ion-item",14),t.bIt("click",function(){t.eBV(e);const c=t.XpG(3);return t.Njj(c.getOffer())}),t.j41(1,"label"),t.EFF(2),t.DNE(3,g,2,3,"small",37),t.k0s(),t.nrm(4,"ion-icon",38),t.k0s()}if(2&a){const e=t.XpG(3);t.R7$(2),t.SpI("",e.text.discount_offers," "),t.R7$(),t.Y8G("ngIf",e.save)}}function _(a,d){if(1&a){const e=t.RV6();t.j41(0,"ion-button",40),t.bIt("click",function(){t.eBV(e);const c=t.XpG(3);return t.Njj(c.placeOrder())}),t.EFF(1),t.k0s()}if(2&a){const e=t.XpG(3);t.R7$(),t.JRh(e.text.checkout_button)}}function P(a,d){if(1&a){const e=t.RV6();t.j41(0,"div")(1,"ion-row"),t.DNE(2,m,2,0,"ion-col",12),t.j41(3,"ion-col",13)(4,"ion-item",14),t.bIt("click",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.getAddress())}),t.j41(5,"label"),t.EFF(6),t.DNE(7,x,2,1,"small",15),t.k0s(),t.nrm(8,"ion-icon",16),t.k0s(),t.nrm(9,"br"),t.j41(10,"p",17),t.EFF(11),t.k0s(),t.j41(12,"ion-item",18)(13,"ion-select",19),t.mxI("ngModelChange",function(c){t.eBV(e);const f=t.XpG(2);return t.DH7(f.sub_time,c)||(f.sub_time=c),t.Njj(c)}),t.bIt("ionChange",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.startDate())}),t.DNE(14,k,2,2,"ion-select-option",20),t.k0s(),t.nrm(15,"ion-icon",21),t.k0s(),t.nrm(16,"br"),t.j41(17,"p",17),t.EFF(18),t.k0s(),t.j41(19,"ion-item",18)(20,"ion-select",22),t.mxI("ngModelChange",function(c){t.eBV(e);const f=t.XpG(2);return t.DH7(f.start_date,c)||(f.start_date=c),t.Njj(c)}),t.bIt("ionChange",function(){t.eBV(e);const c=t.XpG(2);return t.Njj(c.startDate())}),t.DNE(21,j,2,2,"ion-select-option",20),t.k0s(),t.nrm(22,"ion-icon",21),t.k0s(),t.nrm(23,"br"),t.DNE(24,C,4,3,"div",23)(25,l,5,2,"ion-item",24)(26,_,2,1,"ion-button",25),t.k0s()()()}if(2&a){const e=t.XpG(2);t.R7$(2),t.Y8G("ngIf",!e.isMobile),t.R7$(),t.Y8G("size",e.isMobile?12:6),t.R7$(3),t.SpI("",e.text.delivery_address," "),t.R7$(),t.Y8G("ngIf",e.address),t.R7$(4),t.JRh(e.text.checkout_desc),t.R7$(2),t.FS9("label",e.text.sub_time_title),t.R50("ngModel",e.sub_time),t.R7$(),t.Y8G("ngForOf",e.data.time),t.R7$(4),t.JRh(e.text.starting_date_desc),t.R7$(2),t.FS9("label",e.text.start_date),t.R50("ngModel",e.start_date),t.R7$(),t.Y8G("ngForOf",e.data.dates),t.R7$(3),t.Y8G("ngIf",e.cal),t.R7$(),t.Y8G("ngIf",e.cal&&e.cal.total),t.R7$(),t.Y8G("ngIf",!e.isMobile)}}function R(a,d){if(1&a&&(t.j41(0,"ion-content",5)(1,"ion-grid",9),t.DNE(2,b,2,1,"div",2)(3,P,27,15,"div",2),t.k0s()()),2&a){const e=t.XpG();t.R7$(),t.Y8G("fixed",!0),t.R7$(),t.Y8G("ngIf",!e.data),t.R7$(),t.Y8G("ngIf",e.data)}}function I(a,d){if(1&a&&(t.j41(0,"ion-button",41),t.EFF(1),t.k0s()),2&a){const e=t.XpG();t.R7$(),t.JRh(e.text.checkout_button)}}function E(a,d){1&a&&(t.j41(0,"ion-button",42),t.nrm(1,"ion-spinner",43),t.k0s())}function N(a,d){if(1&a&&(t.j41(0,"p",50),t.EFF(1),t.k0s()),2&a){const e=t.XpG(3);t.R7$(),t.LHq("",e.text.you_have_to," ",e.cal.currency,"",e.total-e.data.user.wallet," ",e.text.add_more,"")}}function Y(a,d){if(1&a){const e=t.RV6();t.j41(0,"ion-button",51),t.bIt("click",function(){t.eBV(e);const c=t.XpG(3);return t.Njj(c.placeOrder())}),t.EFF(1),t.k0s()}if(2&a){const e=t.XpG(3);t.R7$(),t.JRh(e.text.checkout_button)}}function W(a,d){1&a&&(t.j41(0,"ion-button",42),t.nrm(1,"ion-spinner",43),t.k0s())}function A(a,d){if(1&a&&(t.j41(0,"div",45)(1,"h3",46),t.EFF(2),t.k0s(),t.j41(3,"ion-item")(4,"ion-label"),t.EFF(5),t.j41(6,"span",47),t.EFF(7),t.k0s()()(),t.j41(8,"ion-item")(9,"ion-label"),t.EFF(10),t.j41(11,"span",47),t.EFF(12),t.k0s()()(),t.DNE(13,N,2,4,"p",48),t.nrm(14,"br"),t.DNE(15,Y,2,1,"ion-button",49)(16,W,2,0,"ion-button",7),t.k0s()),2&a){const e=t.XpG(2);t.R7$(2),t.JRh(e.text.summery),t.R7$(3),t.SpI("",e.text.total_amount," "),t.R7$(2),t.Lme("",e.cal.currency,"",e.total,""),t.R7$(3),t.SpI("",e.text.wallet_amount," "),t.R7$(2),t.Lme("",e.cal.currency,"",e.data.user.wallet,""),t.R7$(),t.Y8G("ngIf",e.total>e.data.user.wallet),t.R7$(2),t.Y8G("ngIf",!e.hasClick),t.R7$(),t.Y8G("ngIf",e.hasClick)}}function U(a,d){1&a&&(t.j41(0,"ion-modal",44),t.DNE(1,A,17,10,"ng-template"),t.k0s()),2&a&&t.Y8G("initialBreakpoint",1)("breakpoints",t.lJ4(2,S))}(0,n.kz)();let z=(()=>{var a;class d{constructor(i,c,f){this.server=i,this.otherService=c,this.modalCtrl=f,this.fakeData=[1,2,3,4,5,6],this.hasClick=!1,this.show=!0,this.isMobile=!1,this.otherService.statusBar("#ffffff",2);const O=localStorage.getItem("app_lang");null!==O&&(this.text=JSON.parse(O),this.text=this.text.text),this.checkScreenSize()}onResize(i){this.checkScreenSize()}checkScreenSize(){this.isMobile=window.innerWidth<=768}ngOnInit(){}ionViewDidEnter(){this.loadData()}loadData(){var i=this;return(0,h.A)(function*(){i.server.checkoutData().subscribe(c=>{i.data=c.data,console.log("this.data",i.data),i.savedAddress=i.data.address})})()}validate(){return!!(this.sub_time&&this.start_date&&this.address)}getAddress(){var i=this;return(0,h.A)(function*(){const c={data:i.savedAddress,store_id:i.data.store.id},f=yield i.modalCtrl.create({component:M.AddressPage,animated:!0,mode:"ios",componentProps:c});return f.onDidDismiss().then(O=>{console.log(O),O.data.id&&(i.address=O.data)}),yield f.present()})()}startDate(){var i=this;return(0,h.A)(function*(){if(!i.sub_time)return i.otherService.toast(i.text.sub_time);if(!i.start_date)return;i.otherService.showLoading();const c={plan:i.sub_time,start_date:i.start_date,cart_no:localStorage.getItem("cart_no"),user_id:localStorage.getItem("user_id"),store_id:i.data.store.id};i.server.getAmount(c).subscribe(f=>{i.cal=f,i.total=i.cal.total,i.otherService.hideLoading(),console.log(i.cal.summery)})})()}checkout(){var i=this;return(0,h.A)(function*(){i.hasClick=!0;const c={user_id:localStorage.getItem("user_id"),cart_no:localStorage.getItem("cart_no"),cal:i.cal,address:i.address.id,plan:i.sub_time,total:i.total,discount:i.save,store_id:i.data.store.id,notes:localStorage.getItem("order_notes")&&"undefined"!=localStorage.getItem("order_notes")?localStorage.getItem("order_notes"):null};i.server.placeOrder(c).subscribe(f=>{1==f.done?(i.show=!1,localStorage.removeItem("order_notes"),i.otherService.redirect("success")):i.otherService.toast(f.error),i.hasClick=!1})})()}placeOrder(){var i=this;return(0,h.A)(function*(){i.validate()?i.total>i.data.user.wallet?i.openModel({amount:i.total-i.data.user.wallet,stripe_key:i.data.stripe_id}):i.checkout():i.otherService.toast(i.text.all_field)})()}openModel(i){var c=this;return(0,h.A)(function*(){const f=yield c.modalCtrl.create({component:D.PaymentPage,animated:!0,mode:"ios",componentProps:{data:i}});return f.onDidDismiss().then(O=>{O.data?c.checkout():c.otherService.toast(c.text.payment_cancel)}),yield f.present()})()}getOffer(){var i=this;return(0,h.A)(function*(){const c=yield i.modalCtrl.create({component:T.OfferPage,animated:!0,mode:"ios",componentProps:{data:i.data.offer}});return c.onDidDismiss().then(f=>{f.data.code&&(i.offer=f.data,i.applyOffer())}),yield c.present()})()}applyOffer(){var i=this;return(0,h.A)(function*(){if(1==i.offer.type){const c=i.cal.total*i.offer.value/100;i.total=i.cal.total-c,i.save=c.toFixed(1)}else i.total=i.cal.total-i.offer.value,i.save=i.offer.value})()}}return(a=d).\u0275fac=function(i){return new(i||a)(t.rXU(G.Z),t.rXU(o.G),t.rXU(s.W3))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-checkout"]],hostBindings:function(i,c){1&i&&t.bIt("resize",function(O){return c.onResize(O)},!1,t.tSv)},decls:12,vars:5,consts:[[1,"ion-no-border"],["color","dark"],[4,"ngIf"],["slot","start"],["class","ion-padding",4,"ngIf"],[1,"ion-padding"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",4,"ngIf"],["mode","ios","color","dark","expand","block",4,"ngIf"],["trigger","open-modal",3,"initialBreakpoint","breakpoints",4,"ngIf"],[3,"fixed"],["class","sek1",3,"animated",4,"ngFor","ngForOf"],[1,"sek1",3,"animated"],["size","6",4,"ngIf"],[3,"size"],["lines","none","detail","",1,"address",3,"click"],["class","address",4,"ngIf"],["name","location-outline","slot","start","color","dark"],[1,"desc"],["lines","none",1,"address"],["placeholder","Select","interface","popover","name","sub_time",3,"ngModelChange","ionChange","label","ngModel"],[3,"value",4,"ngFor","ngForOf"],["name","calendar-outline","slot","start","color","dark"],["placeholder","Select","interface","popover","name","start_date",3,"ngModelChange","ionChange","label","ngModel"],["class","sum",4,"ngIf"],["lines","none","detail","","class","address",3,"click",4,"ngIf"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",3,"click",4,"ngIf"],["size","6"],["src","assets/checkout.webp"],[1,"address"],[3,"value"],[1,"sum"],[4,"ngFor","ngForOf"],["style","font-size: 16px;",4,"ngIf"],["size","12"],["size","12",1,"start"],["size","12",1,"amount"],[2,"font-size","16px"],["class","discount",4,"ngIf"],["name","receipt-outline","slot","start","color","dark"],[1,"discount"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",3,"click"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block"],["mode","ios","color","dark","expand","block"],["name","crescent"],["trigger","open-modal",3,"initialBreakpoint","breakpoints"],[1,"block","ion-padding"],[2,"margin-left","15px"],[2,"float","right"],["align","center","style","font-size: 14px;color:gray",4,"ngIf"],["mode","ios","color","dark","expand","block",3,"click",4,"ngIf"],["align","center",2,"font-size","14px","color","gray"],["mode","ios","color","dark","expand","block",3,"click"]],template:function(i,c){1&i&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1),t.DNE(2,$,2,1,"ion-title",2),t.j41(3,"ion-buttons",3),t.nrm(4,"ion-back-button"),t.k0s()()(),t.DNE(5,R,4,3,"ion-content",4),t.j41(6,"ion-footer",0)(7,"ion-toolbar")(8,"div",5),t.DNE(9,I,2,1,"ion-button",6)(10,E,2,0,"ion-button",7)(11,U,2,3,"ion-modal",8),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("ngIf",c.text),t.R7$(3),t.Y8G("ngIf",c.text),t.R7$(4),t.Y8G("ngIf",!c.hasClick&&c.isMobile),t.R7$(),t.Y8G("ngIf",c.hasClick&&c.isMobile),t.R7$(),t.Y8G("ngIf",c.cal&&c.cal.total&&c.address&&c.show))},dependencies:[s.bv,s.Jm,s.QW,s.hU,s.W9,s.M0,s.lO,s.eU,s.iq,s.uz,s.he,s.ln,s.Nm,s.Ip,s.ds,s.w2,s.BC,s.ai,s.Sb,s.Je,s.el,v.MD,v.Sq,v.bT,F.YN,F.BC,F.vS],styles:["ion-item[_ngcontent-%COMP%]{border-radius:10px;color:#000!important}.sum[_ngcontent-%COMP%]{border:1px solid #d9d9d9;margin-bottom:20px;background-color:#f3efe1;border-radius:10px}.sum[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{border-bottom:1px solid #d9d9d9;padding:10px}.sum[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding:5px 10px;font-size:20px}.block[_ngcontent-%COMP%]{width:100%;height:300px}ion-modal[_ngcontent-%COMP%]{--height: auto}.address[_ngcontent-%COMP%]{--min-height: 60px !important;--padding-start: 20px;--padding-end: 20px;--background: var(--ion-color-light)}.sek1[_ngcontent-%COMP%]{width:96%;height:50px;border-radius:10px;margin-left:2%;margin-top:10%}.address[_ngcontent-%COMP%]{display:block;margin-top:5px;color:gray}.desc[_ngcontent-%COMP%]{font-size:14px;color:gray}.amount[_ngcontent-%COMP%]{font-size:14px}.start[_ngcontent-%COMP%]{font-size:14px;margin-top:10px}.discount[_ngcontent-%COMP%]{display:block;margin-top:5px;color:red}"]}),d})()},5864:(L,y,r)=>{r.r(y),r.d(y,{OfferPage:()=>$});var h=r(467),v=r(177),F=r(4341),s=r(4742),n=r(4438),M=r(9568),D=r(3656);function T(p,b){if(1&p){const m=n.RV6();n.j41(0,"ion-button",4),n.bIt("click",function(){n.eBV(m);const k=n.XpG();return n.Njj(k.close())}),n.EFF(1),n.k0s()}if(2&p){const m=n.XpG();n.R7$(),n.JRh(m.text.cancel)}}function t(p,b){if(1&p&&(n.j41(0,"p",8),n.EFF(1),n.k0s()),2&p){const m=n.XpG(2);n.R7$(),n.JRh(m.text.no_offer)}}function G(p,b){if(1&p){const m=n.RV6();n.j41(0,"ion-item",11),n.bIt("click",function(){const k=n.eBV(m).$implicit,j=n.XpG(3);return n.Njj(j.setOffer(k))}),n.j41(1,"ion-avatar",12),n.nrm(2,"img",13),n.k0s(),n.j41(3,"ion-label",14)(4,"b"),n.EFF(5),n.k0s(),n.j41(6,"span",15),n.EFF(7),n.k0s()()()}if(2&p){const m=b.$implicit;n.R7$(5),n.JRh(m.code),n.R7$(2),n.JRh(m.desc)}}function o(p,b){if(1&p&&(n.j41(0,"div")(1,"ion-note",9),n.EFF(2),n.k0s(),n.nrm(3,"br")(4,"br"),n.DNE(5,G,8,2,"ion-item",10),n.k0s()),2&p){const m=n.XpG(2);n.R7$(2),n.JRh(m.text.avilable_offer),n.R7$(3),n.Y8G("ngForOf",m.data)}}function S(p,b){if(1&p&&(n.j41(0,"ion-content",5),n.DNE(1,t,2,1,"p",6)(2,o,6,2,"div",7),n.k0s()),2&p){const m=n.XpG();n.R7$(),n.Y8G("ngIf",m.data&&0==m.data.length),n.R7$(),n.Y8G("ngIf",m.data&&m.data.length>0)}}let $=(()=>{var p;class b{constructor(x,k){this.otherService=x,this.navParams=k,this.data=k.get("data");const j=localStorage.getItem("app_lang");null!==j&&(this.text=JSON.parse(j),this.text=this.text.text)}ngOnInit(){}close(x=null){var k=this;return(0,h.A)(function*(){k.otherService.closeModel(x)})()}setOffer(x){var k=this;return(0,h.A)(function*(){k.otherService.closeModel(x)})()}}return(p=b).\u0275fac=function(x){return new(x||p)(n.rXU(M.G),n.rXU(D.y8))},p.\u0275cmp=n.VBU({type:p,selectors:[["app-offer"]],decls:5,vars:2,consts:[[1,"ion-no-border"],["slot","end"],["color","medium",3,"click",4,"ngIf"],["class","ion-padding",4,"ngIf"],["color","medium",3,"click"],[1,"ion-padding"],["align","center",4,"ngIf"],[4,"ngIf"],["align","center"],[2,"color","black"],["lines","none","detail","",3,"click",4,"ngFor","ngForOf"],["lines","none","detail","",3,"click"],["slot","start"],["src","assets/discount-icon.png"],[1,"ion-text-wrap"],[2,"display","block","margin-top","5px"]],template:function(x,k){1&x&&(n.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),n.DNE(3,T,2,1,"ion-button",2),n.k0s()()(),n.DNE(4,S,3,2,"ion-content",3)),2&x&&(n.R7$(3),n.Y8G("ngIf",k.text),n.R7$(),n.Y8G("ngIf",k.data&&k.text))},dependencies:[s.bv,s.mC,s.Jm,s.QW,s.W9,s.eU,s.uz,s.he,s.JI,s.ai,v.MD,v.Sq,v.bT,F.YN],styles:["ion-item[_ngcontent-%COMP%]{margin-top:20px;--min-height: 50px !important;border-radius:5px}ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light)}"]}),b})()},5704:(L,y,r)=>{r.r(y),r.d(y,{PaymentPage:()=>B});var h=r(467),v=r(177),F=r(4341),s=r(4742),n=r(5083),M=r(3923);const D=(0,n.F3)("Stripe",{web:()=>r.e(1651).then(r.bind(r,1651)).then(u=>new u.StripeWeb)});var T=r(1594),t=r(9350),o=r(4438),S=r(3656),$=r(9568),p=r(1626),b=r(2068);function m(u,C){if(1&u){const g=o.RV6();o.j41(0,"ion-button",4),o.bIt("click",function(){o.eBV(g);const _=o.XpG();return o.Njj(_.close())}),o.EFF(1),o.k0s()}if(2&u){const g=o.XpG();o.R7$(),o.JRh(g.text.cancel)}}function x(u,C){1&u&&o.nrm(0,"ion-spinner",13)}function k(u,C){if(1&u){const g=o.RV6();o.j41(0,"ion-item",8),o.bIt("click",function(){o.eBV(g);const _=o.XpG(2);return o.Njj(_.paymentSheet())}),o.j41(1,"ion-thumbnail",9),o.nrm(2,"img",12),o.k0s(),o.j41(3,"ion-label"),o.EFF(4),o.k0s(),o.DNE(5,x,1,0,"ion-spinner",11),o.k0s()}if(2&u){const g=o.XpG(2);o.R7$(4),o.JRh(g.text.credit),o.R7$(),o.Y8G("ngIf",1==g.payment_method)}}function j(u,C){1&u&&o.nrm(0,"ion-spinner",13)}function X(u,C){if(1&u){const g=o.RV6();o.j41(0,"ion-content",5)(1,"h3"),o.EFF(2),o.j41(3,"ion-badge",6),o.EFF(4),o.k0s()(),o.nrm(5,"br")(6,"br"),o.DNE(7,k,6,2,"ion-item",7),o.nrm(8,"br"),o.j41(9,"ion-item",8),o.bIt("click",function(){o.eBV(g);const _=o.XpG();return o.Njj(_.payWithRazorpay())}),o.j41(10,"ion-label"),o.EFF(11),o.k0s(),o.j41(12,"ion-thumbnail",9),o.nrm(13,"img",10),o.k0s(),o.DNE(14,j,1,0,"ion-spinner",11),o.k0s(),o.nrm(15,"br")(16,"br")(17,"br")(18,"br"),o.j41(19,"b"),o.EFF(20,"For stripe use these Test card detail : "),o.k0s(),o.j41(21,"p"),o.EFF(22,"Card No : 4242 4242 4242 4242"),o.k0s(),o.j41(23,"p"),o.EFF(24,"Exp. 12/25 CVV : 321"),o.k0s()()}if(2&u){const g=o.XpG();o.R7$(2),o.SpI("",g.text.select_payment_method," "),o.R7$(2),o.Lme("",g.setting.currency,"",g.data.amount,""),o.R7$(3),o.Y8G("ngIf",g.setting.stripe_key),o.R7$(4),o.SpI(" ",g.text.upi,""),o.R7$(3),o.Y8G("ngIf",2==g.payment_method)}}let B=(()=>{var u;class C{constructor(l,_,P,R){this.navParams=l,this.otherService=_,this.http=P,this.server=R,this.data=l.get("data");const I=localStorage.getItem("admin_setting"),E=localStorage.getItem("user_data");null!==I&&(this.setting=JSON.parse(I)),null!==E&&(this.user=JSON.parse(E));const N=localStorage.getItem("app_lang");null!==N&&(this.text=JSON.parse(N),this.text=this.text.text),D.initialize({publishableKey:this.data.stripe_key}),this.meta={counsumer_id:778383,consumer_mac:"sdjksfhsd887f8s"},this.customizations={title:"Wallet Recharge",description:"Wallet Recharge",logo:"https://dicont.s3.amazonaws.com/static/flow-logos/flutterwave-logo.png"},this.customerDetails={name:this.user.name,email:this.user.email,phone_number:this.user.phone}}ngOnInit(){}updateWallet(l=null){var _=this;return(0,h.A)(function*(){const P={amount:_.data.amount,user_id:localStorage.getItem("user_id"),trans_id:l,payment_method:_.payment_method,notes:"Wallet Recharge"};_.server.updateWallet(P).subscribe(R=>{_.payment_method=null,_.otherService.toast(_.text.payment_added),_.close(l)})})()}close(l=null){var _=this;return(0,h.A)(function*(){_.otherService.closeModel(l)})()}httpPost(){const l={user:localStorage.getItem("user_id"),total:this.data.amount};return this.http.post(this.server.getApiUrl()+"stripePayment",l).pipe((0,T.$)())}paymentSheet(){var l=this;return(0,h.A)(function*(){l.payment_method=1;try{D.addListener(M.SQ.Completed,()=>{console.log("PaymentSheetEventsEnum.Completed")});const _=l.httpPost();console.log(_);const{paymentIntent:P,ephemeralKey:R,customer:I}=yield function G(u,C){const g="object"==typeof C;return new Promise((l,_)=>{let R,P=!1;u.subscribe({next:I=>{R=I,P=!0},error:_,complete:()=>{P?l(R):g?l(C.defaultValue):_(new t.G)}})})}(_);yield D.createPaymentSheet({paymentIntentClientSecret:P,customerId:I,customerEphemeralKeySecret:R,merchantDisplayName:l.setting.app_name});const E=yield D.presentPaymentSheet();console.log("result: ",E),E&&E.paymentResult===M.SQ.Completed?l.updateWallet(l.splitAndJoin(P)):l.otherService.toast(l.text.payment_cancel)}catch{l.otherService.toast(l.text.payment_cancel)}})()}splitAndJoin(l){const _=l.split("_").slice(0,2).join("_");return console.log(_),_}payWithRazorpay(){var l=this;return(0,h.A)(function*(){RazorpayCheckout.open({description:"Pay Now",image:"https://cdn.iconscout.com/icon/free/png-512/bhim-3-69845.png",currency:"INR",key:l.setting.razor_key,amount:100*l.data.amount,name:l.user.name,prefill:{email:l.user.email,contact:l.user.phone},theme:{color:"#2196f3"},modal:{ondismiss:function(){alert("dismissed")}}},I=>{l.updateWallet(Date.now())},I=>{l.otherService.toast(l.text.payment_cancel)})})()}}return(u=C).\u0275fac=function(l){return new(l||u)(o.rXU(S.y8),o.rXU($.G),o.rXU(p.Qq),o.rXU(b.Z))},u.\u0275cmp=o.VBU({type:u,selectors:[["app-payment"]],decls:5,vars:2,consts:[[1,"ion-no-border"],["slot","end"],["color","medium",3,"click",4,"ngIf"],["class","ion-padding",4,"ngIf"],["color","medium",3,"click"],[1,"ion-padding"],["color","dark",2,"float","right","margin-top","5px"],["lines","none","detail","",3,"click",4,"ngIf"],["lines","none","detail","",3,"click"],["slot","start"],["src","assets/razor.png"],["name","crescent","slot","end",4,"ngIf"],["src","assets/stripe.png"],["name","crescent","slot","end"]],template:function(l,_){1&l&&(o.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),o.DNE(3,m,2,1,"ion-button",2),o.k0s()()(),o.DNE(4,X,25,6,"ion-content",3)),2&l&&(o.R7$(3),o.Y8G("ngIf",_.text),o.R7$(),o.Y8G("ngIf",_.data&&_.text))},dependencies:[s.bv,s.In,s.Jm,s.QW,s.W9,s.eU,s.uz,s.he,s.w2,s.Zx,s.ai,v.MD,v.bT,F.YN],styles:["ion-item[_ngcontent-%COMP%]{border-radius:5px;--min-height:60px;border:1px solid #f1f1f1}ion-toolbar[_ngcontent-%COMP%]{--background: white}ion-thumbnail[_ngcontent-%COMP%]{width:32px;height:32px}"]}),C})()}}]);