"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5704,5864,9738],{3923:(N,P,_)=>{_.d(P,{$o:()=>k,_G:()=>x,Vq:()=>C,SQ:()=>l});var k=function(e){return e.Loaded="applePayLoaded",e.FailedToLoad="applePayFailedToLoad",e.Completed="applePayCompleted",e.Canceled="applePayCanceled",e.Failed="applePayFailed",e.DidSelectShippingContact="applePayDidSelectShippingContact",e.DidCreatePaymentMethod="applePayDidCreatePaymentMethod",e}(k||{}),x=function(e){return e.Loaded="googlePayLoaded",e.FailedToLoad="googlePayFailedToLoad",e.Completed="googlePayCompleted",e.Canceled="googlePayCanceled",e.Failed="googlePayFailed",e}(x||{}),C=function(e){return e.Loaded="paymentFlowLoaded",e.FailedToLoad="paymentFlowFailedToLoad",e.Opened="paymentFlowOpened",e.Created="paymentFlowCreated",e.Completed="paymentFlowCompleted",e.Canceled="paymentFlowCanceled",e.Failed="paymentFlowFailed",e}(C||{}),l=function(e){return e.Loaded="paymentSheetLoaded",e.FailedToLoad="paymentSheetFailedToLoad",e.Completed="paymentSheetCompleted",e.Canceled="paymentSheetCanceled",e.Failed="paymentSheetFailed",e}(l||{})},9738:(N,P,_)=>{_.r(P),_.d(P,{CheckoutPage:()=>W});var k=_(467),x=_(177),C=_(4341),l=_(4742),e=_(4531),O=_(7564),F=_(5704),D=_(5864),t=_(4438),M=_(2068),r=_(9568);const j=()=>[0,1];function T(a,m){if(1&a&&(t.j41(0,"ion-title"),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.text.checkout_title)}}function S(a,m){1&a&&t.nrm(0,"ion-skeleton-text",11),2&a&&t.Y8G("animated",!0)}function E(a,m){if(1&a&&(t.j41(0,"div"),t.DNE(1,S,1,1,"ion-skeleton-text",10),t.k0s()),2&a){const n=t.XpG(2);t.R7$(),t.Y8G("ngForOf",n.fakeData)}}function G(a,m){1&a&&(t.j41(0,"ion-col",26),t.nrm(1,"img",27),t.k0s())}function u(a,m){if(1&a&&(t.j41(0,"small",28),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.address.address)}}function v(a,m){if(1&a&&(t.j41(0,"ion-select-option",29),t.EFF(1),t.k0s()),2&a){const n=m.$implicit;t.Y8G("value",n.id),t.R7$(),t.JRh(n.title)}}function c(a,m){if(1&a&&(t.j41(0,"ion-select-option",29),t.EFF(1),t.k0s()),2&a){const n=m.$implicit;t.Y8G("value",n),t.R7$(),t.JRh(n)}}function f(a,m){if(1&a&&(t.j41(0,"ion-row")(1,"ion-col",33),t.EFF(2),t.k0s(),t.j41(3,"ion-col",34),t.EFF(4),t.k0s(),t.j41(5,"ion-col",35),t.EFF(6),t.k0s(),t.j41(7,"ion-col",35),t.EFF(8),t.k0s()()),2&a){const n=m.$implicit,o=t.XpG(4);t.R7$(2),t.Lme("",n.item," - ",n.type,""),t.R7$(2),t.LHq("",o.text.start," : ",n.start," | ",o.text.valid," : ",n.end,""),t.R7$(2),t.Lme("",o.text.total_day_count," : ",n.dayCount,""),t.R7$(2),t.ZXR("",o.text.amount," : ",n.currency,"",n.price," x ",n.dayCount," = ",n.currency,"",n.total_price,"")}}function p(a,m){if(1&a&&(t.j41(0,"h3"),t.EFF(1),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.E5c("",n.text.payable_amount," : ",n.cal.currency,"",n.cal.total,"")}}function i(a,m){if(1&a&&(t.j41(0,"h3",36),t.EFF(1),t.j41(2,"s"),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.SpI("",n.text.payable_amount," : "),t.R7$(2),t.Lme("",n.cal.currency,"",n.cal.total,""),t.R7$(),t.Lme(" ",n.cal.currency,"",n.total,"")}}function d(a,m){if(1&a&&(t.j41(0,"div",30),t.DNE(1,f,9,14,"ion-row",31)(2,p,2,3,"h3",2)(3,i,5,5,"h3",32),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.Y8G("ngForOf",n.cal.summery),t.R7$(),t.Y8G("ngIf",!n.save),t.R7$(),t.Y8G("ngIf",n.save)}}function g(a,m){if(1&a&&(t.j41(0,"small",39),t.EFF(1),t.k0s()),2&a){const n=t.XpG(4);t.R7$(),t.E5c("",n.text.you_save," ",n.cal.currency,"",n.save,"")}}function y(a,m){if(1&a){const n=t.RV6();t.j41(0,"ion-item",14),t.bIt("click",function(){t.eBV(n);const s=t.XpG(3);return t.Njj(s.getOffer())}),t.j41(1,"label"),t.EFF(2),t.DNE(3,g,2,3,"small",37),t.k0s(),t.nrm(4,"ion-icon",38),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(2),t.SpI("",n.text.discount_offers," "),t.R7$(),t.Y8G("ngIf",n.save)}}function b(a,m){if(1&a){const n=t.RV6();t.j41(0,"ion-button",40),t.bIt("click",function(){t.eBV(n);const s=t.XpG(3);return t.Njj(s.placeOrder())}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.text.checkout_button)}}function I(a,m){if(1&a){const n=t.RV6();t.j41(0,"div")(1,"ion-row"),t.DNE(2,G,2,0,"ion-col",12),t.j41(3,"ion-col",13)(4,"ion-item",14),t.bIt("click",function(){t.eBV(n);const s=t.XpG(2);return t.Njj(s.getAddress())}),t.j41(5,"label"),t.EFF(6),t.DNE(7,u,2,1,"small",15),t.k0s(),t.nrm(8,"ion-icon",16),t.k0s(),t.nrm(9,"br"),t.j41(10,"p",17),t.EFF(11),t.k0s(),t.j41(12,"ion-item",18)(13,"ion-select",19),t.mxI("ngModelChange",function(s){t.eBV(n);const h=t.XpG(2);return t.DH7(h.sub_time,s)||(h.sub_time=s),t.Njj(s)}),t.bIt("ionChange",function(){t.eBV(n);const s=t.XpG(2);return t.Njj(s.startDate())}),t.DNE(14,v,2,2,"ion-select-option",20),t.k0s(),t.nrm(15,"ion-icon",21),t.k0s(),t.nrm(16,"br"),t.j41(17,"p",17),t.EFF(18),t.k0s(),t.j41(19,"ion-item",18)(20,"ion-select",22),t.mxI("ngModelChange",function(s){t.eBV(n);const h=t.XpG(2);return t.DH7(h.start_date,s)||(h.start_date=s),t.Njj(s)}),t.bIt("ionChange",function(){t.eBV(n);const s=t.XpG(2);return t.Njj(s.startDate())}),t.DNE(21,c,2,2,"ion-select-option",20),t.k0s(),t.nrm(22,"ion-icon",21),t.k0s(),t.nrm(23,"br"),t.DNE(24,d,4,3,"div",23)(25,y,5,2,"ion-item",24)(26,b,2,1,"ion-button",25),t.k0s()()()}if(2&a){const n=t.XpG(2);t.R7$(2),t.Y8G("ngIf",!n.isMobile),t.R7$(),t.Y8G("size",n.isMobile?12:6),t.R7$(3),t.SpI("",n.text.delivery_address," "),t.R7$(),t.Y8G("ngIf",n.address),t.R7$(4),t.JRh(n.text.checkout_desc),t.R7$(2),t.FS9("label",n.text.sub_time_title),t.R50("ngModel",n.sub_time),t.R7$(),t.Y8G("ngForOf",n.data.time),t.R7$(4),t.JRh(n.text.starting_date_desc),t.R7$(2),t.FS9("label",n.text.start_date),t.R50("ngModel",n.start_date),t.R7$(),t.Y8G("ngForOf",n.data.dates),t.R7$(3),t.Y8G("ngIf",n.cal),t.R7$(),t.Y8G("ngIf",n.cal&&n.cal.total),t.R7$(),t.Y8G("ngIf",!n.isMobile)}}function $(a,m){if(1&a&&(t.j41(0,"ion-content",5)(1,"ion-grid",9),t.DNE(2,E,2,1,"div",2)(3,I,27,15,"div",2),t.k0s()()),2&a){const n=t.XpG();t.R7$(),t.Y8G("fixed",!0),t.R7$(),t.Y8G("ngIf",!n.data),t.R7$(),t.Y8G("ngIf",n.data)}}function L(a,m){if(1&a&&(t.j41(0,"ion-button",41),t.EFF(1),t.k0s()),2&a){const n=t.XpG();t.R7$(),t.JRh(n.text.checkout_button)}}function X(a,m){1&a&&(t.j41(0,"ion-button",42),t.nrm(1,"ion-spinner",43),t.k0s())}function B(a,m){if(1&a&&(t.j41(0,"p",50),t.EFF(1),t.k0s()),2&a){const n=t.XpG(3);t.R7$(),t.LHq("",n.text.you_have_to," ",n.cal.currency,"",n.total-n.data.user.wallet," ",n.text.add_more,"")}}function z(a,m){if(1&a){const n=t.RV6();t.j41(0,"ion-button",51),t.bIt("click",function(){t.eBV(n);const s=t.XpG(3);return t.Njj(s.placeOrder())}),t.EFF(1),t.k0s()}if(2&a){const n=t.XpG(3);t.R7$(),t.JRh(n.text.checkout_button)}}function A(a,m){1&a&&(t.j41(0,"ion-button",42),t.nrm(1,"ion-spinner",43),t.k0s())}function Y(a,m){if(1&a&&(t.j41(0,"div",45)(1,"h3",46),t.EFF(2),t.k0s(),t.j41(3,"ion-item")(4,"ion-label"),t.EFF(5),t.j41(6,"span",47),t.EFF(7),t.k0s()()(),t.j41(8,"ion-item")(9,"ion-label"),t.EFF(10),t.j41(11,"span",47),t.EFF(12),t.k0s()()(),t.DNE(13,B,2,4,"p",48),t.nrm(14,"br"),t.DNE(15,z,2,1,"ion-button",49)(16,A,2,0,"ion-button",7),t.k0s()),2&a){const n=t.XpG(2);t.R7$(2),t.JRh(n.text.summery),t.R7$(3),t.SpI("",n.text.total_amount," "),t.R7$(2),t.Lme("",n.cal.currency,"",n.total,""),t.R7$(3),t.SpI("",n.text.wallet_amount," "),t.R7$(2),t.Lme("",n.cal.currency,"",n.data.user.wallet,""),t.R7$(),t.Y8G("ngIf",n.total>n.data.user.wallet),t.R7$(2),t.Y8G("ngIf",!n.hasClick),t.R7$(),t.Y8G("ngIf",n.hasClick)}}function U(a,m){1&a&&(t.j41(0,"ion-modal",44),t.DNE(1,Y,17,10,"ng-template"),t.k0s()),2&a&&t.Y8G("initialBreakpoint",1)("breakpoints",t.lJ4(2,j))}(0,e.kz)();let W=(()=>{var a;class m{constructor(o,s,h){this.server=o,this.otherService=s,this.modalCtrl=h,this.fakeData=[1,2,3,4,5,6],this.hasClick=!1,this.show=!0,this.isMobile=!1,this.otherService.statusBar("#ffffff",2);const R=localStorage.getItem("app_lang");null!==R&&(this.text=JSON.parse(R),this.text=this.text.text),this.checkScreenSize()}onResize(o){this.checkScreenSize()}checkScreenSize(){this.isMobile=window.innerWidth<=768}ngOnInit(){}ionViewDidEnter(){this.loadData()}loadData(){var o=this;return(0,k.A)(function*(){o.server.checkoutData().subscribe(s=>{o.data=s.data,console.log("this.data",o.data),o.savedAddress=o.data.address})})()}validate(){return!!(this.sub_time&&this.start_date&&this.address)}getAddress(){var o=this;return(0,k.A)(function*(){const s={data:o.savedAddress,store_id:o.data.store.id},h=yield o.modalCtrl.create({component:O.AddressPage,animated:!0,mode:"ios",componentProps:s});return h.onDidDismiss().then(R=>{console.log(R),R.data.id&&(o.address=R.data)}),yield h.present()})()}startDate(){var o=this;return(0,k.A)(function*(){if(!o.sub_time)return o.otherService.toast(o.text.sub_time);if(!o.start_date)return;o.otherService.showLoading();const s={plan:o.sub_time,start_date:o.start_date,cart_no:localStorage.getItem("cart_no"),user_id:localStorage.getItem("user_id"),store_id:o.data.store.id};o.server.getAmount(s).subscribe(h=>{o.cal=h,o.total=o.cal.total,o.otherService.hideLoading(),console.log(o.cal.summery)})})()}checkout(){var o=this;return(0,k.A)(function*(){o.hasClick=!0;const s={user_id:localStorage.getItem("user_id"),cart_no:localStorage.getItem("cart_no"),cal:o.cal,address:o.address.id,plan:o.sub_time,total:o.total,discount:o.save,store_id:o.data.store.id,notes:localStorage.getItem("order_notes")&&"undefined"!=localStorage.getItem("order_notes")?localStorage.getItem("order_notes"):null};o.server.placeOrder(s).subscribe(h=>{1==h.done?(o.show=!1,localStorage.removeItem("order_notes"),o.otherService.redirect("success")):o.otherService.toast(h.error),o.hasClick=!1})})()}placeOrder(){var o=this;return(0,k.A)(function*(){o.validate()?o.total>o.data.user.wallet?o.openModel({amount:o.total-o.data.user.wallet,stripe_key:o.data.stripe_id}):o.checkout():o.otherService.toast(o.text.all_field)})()}openModel(o){var s=this;return(0,k.A)(function*(){const h=yield s.modalCtrl.create({component:F.PaymentPage,animated:!0,mode:"ios",componentProps:{data:o}});return h.onDidDismiss().then(R=>{R.data?s.checkout():s.otherService.toast(s.text.payment_cancel)}),yield h.present()})()}getOffer(){var o=this;return(0,k.A)(function*(){const s=yield o.modalCtrl.create({component:D.OfferPage,animated:!0,mode:"ios",componentProps:{data:o.data.offer}});return s.onDidDismiss().then(h=>{h.data.code&&(o.offer=h.data,o.applyOffer())}),yield s.present()})()}applyOffer(){var o=this;return(0,k.A)(function*(){if(1==o.offer.type){const s=o.cal.total*o.offer.value/100;o.total=o.cal.total-s,o.save=s.toFixed(1)}else o.total=o.cal.total-o.offer.value,o.save=o.offer.value})()}}return(a=m).\u0275fac=function(o){return new(o||a)(t.rXU(M.Z),t.rXU(r.G),t.rXU(l.W3))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-checkout"]],hostBindings:function(o,s){1&o&&t.bIt("resize",function(R){return s.onResize(R)},!1,t.tSv)},decls:12,vars:5,consts:[[1,"ion-no-border"],["color","dark"],[4,"ngIf"],["slot","start"],["class","ion-padding",4,"ngIf"],[1,"ion-padding"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",4,"ngIf"],["mode","ios","color","dark","expand","block",4,"ngIf"],["trigger","open-modal",3,"initialBreakpoint","breakpoints",4,"ngIf"],[3,"fixed"],["class","sek1",3,"animated",4,"ngFor","ngForOf"],[1,"sek1",3,"animated"],["size","6",4,"ngIf"],[3,"size"],["lines","none","detail","",1,"address",3,"click"],["class","address",4,"ngIf"],["name","location-outline","slot","start","color","dark"],[1,"desc"],["lines","none",1,"address"],["placeholder","Select","interface","popover","name","sub_time",3,"ngModelChange","ionChange","label","ngModel"],[3,"value",4,"ngFor","ngForOf"],["name","calendar-outline","slot","start","color","dark"],["placeholder","Select","interface","popover","name","start_date",3,"ngModelChange","ionChange","label","ngModel"],["class","sum",4,"ngIf"],["lines","none","detail","","class","address",3,"click",4,"ngIf"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",3,"click",4,"ngIf"],["size","6"],["src","assets/checkout.webp"],[1,"address"],[3,"value"],[1,"sum"],[4,"ngFor","ngForOf"],["style","font-size: 16px;",4,"ngIf"],["size","12"],["size","12",1,"start"],["size","12",1,"amount"],[2,"font-size","16px"],["class","discount",4,"ngIf"],["name","receipt-outline","slot","start","color","dark"],[1,"discount"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",3,"click"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block"],["mode","ios","color","dark","expand","block"],["name","crescent"],["trigger","open-modal",3,"initialBreakpoint","breakpoints"],[1,"block","ion-padding"],[2,"margin-left","15px"],[2,"float","right"],["align","center","style","font-size: 14px;color:gray",4,"ngIf"],["mode","ios","color","dark","expand","block",3,"click",4,"ngIf"],["align","center",2,"font-size","14px","color","gray"],["mode","ios","color","dark","expand","block",3,"click"]],template:function(o,s){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1),t.DNE(2,T,2,1,"ion-title",2),t.j41(3,"ion-buttons",3),t.nrm(4,"ion-back-button"),t.k0s()()(),t.DNE(5,$,4,3,"ion-content",4),t.j41(6,"ion-footer",0)(7,"ion-toolbar")(8,"div",5),t.DNE(9,L,2,1,"ion-button",6)(10,X,2,0,"ion-button",7)(11,U,2,3,"ion-modal",8),t.k0s()()()),2&o&&(t.R7$(2),t.Y8G("ngIf",s.text),t.R7$(3),t.Y8G("ngIf",s.text),t.R7$(4),t.Y8G("ngIf",!s.hasClick&&s.isMobile),t.R7$(),t.Y8G("ngIf",s.hasClick&&s.isMobile),t.R7$(),t.Y8G("ngIf",s.cal&&s.cal.total&&s.address&&s.show))},dependencies:[l.bv,l.Jm,l.QW,l.hU,l.W9,l.M0,l.lO,l.eU,l.iq,l.uz,l.he,l.ln,l.Nm,l.Ip,l.ds,l.w2,l.BC,l.ai,l.Sb,l.Je,l.el,x.MD,x.Sq,x.bT,C.YN,C.BC,C.vS],styles:["ion-item[_ngcontent-%COMP%]{border-radius:10px;color:#000!important}.sum[_ngcontent-%COMP%]{border:1px solid #d9d9d9;margin-bottom:20px;background-color:#f3efe1;border-radius:10px}.sum[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{border-bottom:1px solid #d9d9d9;padding:10px}.sum[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding:5px 10px;font-size:20px}.block[_ngcontent-%COMP%]{width:100%;height:300px}ion-modal[_ngcontent-%COMP%]{--height: auto}.address[_ngcontent-%COMP%]{--min-height: 60px !important;--padding-start: 20px;--padding-end: 20px;--background: var(--ion-color-light)}.sek1[_ngcontent-%COMP%]{width:96%;height:50px;border-radius:10px;margin-left:2%;margin-top:10%}.address[_ngcontent-%COMP%]{display:block;margin-top:5px;color:gray}.desc[_ngcontent-%COMP%]{font-size:14px;color:gray}.amount[_ngcontent-%COMP%]{font-size:14px}.start[_ngcontent-%COMP%]{font-size:14px;margin-top:10px}.discount[_ngcontent-%COMP%]{display:block;margin-top:5px;color:red}"]}),m})()},5864:(N,P,_)=>{_.r(P),_.d(P,{OfferPage:()=>G});var k=_(467),x=_(177),C=_(4341),l=_(4742),e=_(4438),O=_(9568),F=_(3656);function D(u,v){if(1&u){const c=e.RV6();e.j41(0,"ion-button",4),e.bIt("click",function(){e.eBV(c);const p=e.XpG();return e.Njj(p.close())}),e.EFF(1),e.k0s()}if(2&u){const c=e.XpG();e.R7$(),e.JRh(c.text.cancel)}}function t(u,v){if(1&u&&(e.j41(0,"p",8),e.EFF(1),e.k0s()),2&u){const c=e.XpG(2);e.R7$(),e.JRh(c.text.no_offer)}}function M(u,v){if(1&u&&(e.j41(0,"ion-item",13)(1,"ion-avatar",14),e.nrm(2,"img",15),e.k0s(),e.j41(3,"ion-label",16)(4,"b"),e.EFF(5),e.k0s(),e.j41(6,"span",17),e.EFF(7),e.k0s()()()),2&u){const c=e.XpG().$implicit;e.R7$(5),e.JRh(c.code),e.R7$(2),e.JRh(c.desc)}}function r(u,v){if(1&u){const c=e.RV6();e.j41(0,"div",11),e.bIt("click",function(){const p=e.eBV(c).$implicit,i=e.XpG(3);return e.Njj(i.setOffer(p))}),e.DNE(1,M,8,2,"ion-item",12),e.k0s()}if(2&u){const c=v.$implicit,f=e.XpG(3);e.R7$(),e.Y8G("ngIf","SUBSCRIPTION"==f.type&&"SUBSCRIPTION"==c.subscription)}}function j(u,v){if(1&u&&(e.j41(0,"ion-item",13)(1,"ion-avatar",14),e.nrm(2,"img",15),e.k0s(),e.j41(3,"ion-label",16)(4,"b"),e.EFF(5),e.k0s(),e.j41(6,"span",17),e.EFF(7),e.k0s()()()),2&u){const c=e.XpG().$implicit;e.R7$(5),e.JRh(c.code),e.R7$(2),e.JRh(c.desc)}}function T(u,v){if(1&u){const c=e.RV6();e.j41(0,"div",11),e.bIt("click",function(){const p=e.eBV(c).$implicit,i=e.XpG(3);return e.Njj(i.setOffer(p))}),e.DNE(1,j,8,2,"ion-item",12),e.k0s()}if(2&u){const c=v.$implicit,f=e.XpG(3);e.R7$(),e.Y8G("ngIf","NORMAL"==f.type&&"NORMAL"==c.subscription)}}function S(u,v){if(1&u&&(e.j41(0,"div")(1,"ion-note",9),e.EFF(2),e.k0s(),e.nrm(3,"br")(4,"br"),e.DNE(5,r,2,1,"div",10)(6,T,2,1,"div",10),e.k0s()),2&u){const c=e.XpG(2);e.R7$(2),e.JRh(c.text.avilable_offer),e.R7$(3),e.Y8G("ngForOf",c.data),e.R7$(),e.Y8G("ngForOf",c.data)}}function E(u,v){if(1&u&&(e.j41(0,"ion-content",5),e.DNE(1,t,2,1,"p",6)(2,S,7,3,"div",7),e.k0s()),2&u){const c=e.XpG();e.R7$(),e.Y8G("ngIf",c.data&&0==c.data.length),e.R7$(),e.Y8G("ngIf",c.data&&c.data.length>0)}}let G=(()=>{var u;class v{constructor(f,p){this.otherService=f,this.navParams=p,this.data=p.get("data"),this.type=p.get("type"),console.log("this.type",this.type);const i=localStorage.getItem("app_lang");null!==i&&(this.text=JSON.parse(i),this.text=this.text.text)}ngOnInit(){}close(f=null){var p=this;return(0,k.A)(function*(){p.otherService.closeModel(f)})()}setOffer(f){var p=this;return(0,k.A)(function*(){p.otherService.closeModel(f)})()}}return(u=v).\u0275fac=function(f){return new(f||u)(e.rXU(O.G),e.rXU(F.y8))},u.\u0275cmp=e.VBU({type:u,selectors:[["app-offer"]],decls:5,vars:2,consts:[[1,"ion-no-border"],["slot","end"],["color","medium",3,"click",4,"ngIf"],["class","ion-padding",4,"ngIf"],["color","medium",3,"click"],[1,"ion-padding"],["align","center",4,"ngIf"],[4,"ngIf"],["align","center"],[2,"color","black"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["lines","none","detail","","style","cursor: pointer;",4,"ngIf"],["lines","none","detail","",2,"cursor","pointer"],["slot","start"],["src","assets/discount-icon.png"],[1,"ion-text-wrap"],[2,"display","block","margin-top","5px"]],template:function(f,p){1&f&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.DNE(3,D,2,1,"ion-button",2),e.k0s()()(),e.DNE(4,E,3,2,"ion-content",3)),2&f&&(e.R7$(3),e.Y8G("ngIf",p.text),e.R7$(),e.Y8G("ngIf",p.data&&p.text))},dependencies:[l.bv,l.mC,l.Jm,l.QW,l.W9,l.eU,l.uz,l.he,l.JI,l.ai,x.MD,x.Sq,x.bT,C.YN],styles:["ion-item[_ngcontent-%COMP%]{margin-top:20px;--min-height: 50px !important;border-radius:5px}ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light)}.ion-text-wrap[_ngcontent-%COMP%]{color:#000}ion-toolbar[_ngcontent-%COMP%], ion-header[_ngcontent-%COMP%]{--background: white !important;color:#000!important}"]}),v})()},5704:(N,P,_)=>{_.r(P),_.d(P,{PaymentPage:()=>v});var k=_(467),x=_(177),C=_(4341),l=_(4742),e=_(5083),O=_(3923);const F=(0,e.F3)("Stripe",{web:()=>_.e(1651).then(_.bind(_,1651)).then(c=>new c.StripeWeb)});var D=_(1594),t=_(9350),r=_(4438),j=_(3656),T=_(9568),S=_(1626),E=_(2068);function G(c,f){if(1&c){const p=r.RV6();r.j41(0,"ion-button",4),r.bIt("click",function(){r.eBV(p);const d=r.XpG();return r.Njj(d.close())}),r.EFF(1),r.k0s()}if(2&c){const p=r.XpG();r.R7$(),r.JRh(p.text.cancel)}}function u(c,f){if(1&c){const p=r.RV6();r.j41(0,"ion-content",5)(1,"h3",6),r.EFF(2,"You have insufficient balance in your wallet. Please add "),r.j41(3,"strong"),r.EFF(4),r.k0s(),r.EFF(5," to continue."),r.k0s(),r.nrm(6,"br")(7,"br"),r.j41(8,"ion-row")(9,"ion-col",7),r.nrm(10,"img",8),r.k0s(),r.nrm(11,"br"),r.j41(12,"ion-col",9)(13,"ion-button",10),r.bIt("click",function(){r.eBV(p);const d=r.XpG();return r.Njj(d.addAmountToWallet())}),r.EFF(14),r.nI1(15,"currency"),r.k0s()()()()}if(2&c){const p=r.XpG();r.R7$(4),r.Lme("",p.setting.currency,"",p.data.amount,""),r.R7$(10),r.SpI("Add ",r.i5U(15,3,p.data.amount,"INR")," to Wallet")}}let v=(()=>{var c;class f{constructor(i,d,g,y){this.navParams=i,this.otherService=d,this.http=g,this.server=y,this.options={key:"",amount:0,name:"",description:"The Daily Fruit",image:"",order_id:"",handler:function(L){var X=new CustomEvent("payment.success",{detail:L,bubbles:!0,cancelable:!0});window.dispatchEvent(X)},prefill:{name:"",email:"",contact:""},notes:{address:""},theme:{color:"#3399cc"}},this.message="Not yet stared",this.paymentId="",this.error="",this.data=i.get("data"),this.user_id=localStorage.getItem("user_id");const b=localStorage.getItem("admin_setting"),I=localStorage.getItem("user_data");null!==b&&(this.setting=JSON.parse(b)),null!==I&&(this.user=JSON.parse(I));const $=localStorage.getItem("app_lang");null!==$&&(this.text=JSON.parse($),this.text=this.text.text),F.initialize({publishableKey:this.data.stripe_key}),this.meta={counsumer_id:778383,consumer_mac:"sdjksfhsd887f8s"},this.customizations={title:"Wallet Recharge",description:"Wallet Recharge",logo:"https://dicont.s3.amazonaws.com/static/flow-logos/flutterwave-logo.png"},this.customerDetails={name:this.user.name,email:this.user.email,phone_number:this.user.phone}}ngOnInit(){}addAmountToWallet(){var i=this;return(0,k.A)(function*(){if(i.data.amount){const d={user_id:i.user_id,amount:i.data.amount,notes:"Add To Wallet\xa0Razorpay"};(yield i.server.createRazorpayOrder(d)).subscribe(g=>{i.options.key=g.razor_key.replace(/\r\n/g,""),i.options.order_id=g.order_id,i.options.amount=Number(g.amount),i.options.name="The Daily Fruit",i.options.prefill.name="The Daily Fruit",i.options.prefill.email="support@thedailyfruit.in",i.options.prefill.contact="9998887776",i.payNow()})}else i.otherService.toast(i.text.enter_amount)})()}payNow(){if(typeof Razorpay>"u")console.error("Razorpay is not loaded yet.");else{var i=new Razorpay(this.options);i.open(),i.on("payment.failed",function(d){console.error("Payment failed",d.error)})}}onPaymentSuccess(i){var d=this;return(0,k.A)(function*(){let g=i.detail,y={razorpay_order_id:null==g?void 0:g.razorpay_order_id,razorpay_payment_id:null==g?void 0:g.razorpay_payment_id,razorpay_signature:null==g?void 0:g.razorpay_signature};(yield d.server.verifyRazorpayOrder(y)).subscribe(b=>{d.otherService.triggerLoadData.emit(),d.otherService.closeModel(b)}),d.message="Success Payment"})()}updateWallet(i=null){var d=this;return(0,k.A)(function*(){const g={amount:d.data.amount,user_id:localStorage.getItem("user_id"),trans_id:i,payment_method:d.payment_method,notes:"Wallet Recharge"};d.server.updateWallet(g).subscribe(y=>{d.payment_method=null,d.otherService.toast(d.text.payment_added),d.close(i)})})()}close(i=null){var d=this;return(0,k.A)(function*(){d.otherService.closeModel(i)})()}httpPost(){const i={user:localStorage.getItem("user_id"),total:this.data.amount};return this.http.post(this.server.getApiUrl()+"stripePayment",i).pipe((0,D.$)())}paymentSheet(){var i=this;return(0,k.A)(function*(){i.payment_method=1;try{F.addListener(O.SQ.Completed,()=>{});const d=i.httpPost(),{paymentIntent:g,ephemeralKey:y,customer:b}=yield function M(c,f){const p="object"==typeof f;return new Promise((i,d)=>{let y,g=!1;c.subscribe({next:b=>{y=b,g=!0},error:d,complete:()=>{g?i(y):p?i(f.defaultValue):d(new t.G)}})})}(d);yield F.createPaymentSheet({paymentIntentClientSecret:g,customerId:b,customerEphemeralKeySecret:y,merchantDisplayName:i.setting.app_name});const I=yield F.presentPaymentSheet();I&&I.paymentResult===O.SQ.Completed?i.updateWallet(i.splitAndJoin(g)):i.otherService.toast(i.text.payment_cancel)}catch{i.otherService.toast(i.text.payment_cancel)}})()}splitAndJoin(i){return i.split("_").slice(0,2).join("_")}payWithRazorpay(){return(0,k.A)(function*(){})()}}return(c=f).\u0275fac=function(i){return new(i||c)(r.rXU(j.y8),r.rXU(T.G),r.rXU(S.Qq),r.rXU(E.Z))},c.\u0275cmp=r.VBU({type:c,selectors:[["app-payment"]],hostBindings:function(i,d){1&i&&r.bIt("payment.success",function(y){return d.onPaymentSuccess(y)},!1,r.tSv)},decls:5,vars:2,consts:[[1,"ion-no-border"],["slot","end"],["color","medium",3,"click",4,"ngIf"],["class","ion-padding",4,"ngIf"],["color","medium",3,"click"],[1,"ion-padding"],[2,"color","black"],["size","12",2,"text-align","center"],["src","assets/razorpay.gif",2,"width","40%","height","auto","border-radius","25px"],["size","12"],["mode","ios","expand","block","color","dark","id","open-modal","expand","block",3,"click"]],template:function(i,d){1&i&&(r.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),r.DNE(3,G,2,1,"ion-button",2),r.k0s()()(),r.DNE(4,u,16,6,"ion-content",3)),2&i&&(r.R7$(3),r.Y8G("ngIf",d.text),r.R7$(),r.Y8G("ngIf",d.data&&d.text))},dependencies:[l.bv,l.Jm,l.QW,l.hU,l.W9,l.eU,l.ln,l.ai,x.MD,x.bT,x.oe,C.YN],styles:["ion-item[_ngcontent-%COMP%]{border-radius:5px;--min-height:60px;border:1px solid #f1f1f1}ion-toolbar[_ngcontent-%COMP%]{--background: white}ion-thumbnail[_ngcontent-%COMP%]{width:32px;height:32px}"]}),f})()}}]);